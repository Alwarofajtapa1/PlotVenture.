<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Zaawansowany Formularz Kontaktowy</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f0f2f5;
    padding: 20px;
    display: flex;
    justify-content: center;
  }
  .container {
    background: white;
    max-width: 500px;
    width: 100%;
    border-radius: 8px;
    box-shadow: 0 0 12px rgb(0 0 0 / 0.1);
    padding: 30px;
  }
  h1 {
    text-align: center;
    margin-bottom: 25px;
    color: #222;
  }
  label {
    display: block;
    margin-bottom: 6px;
    font-weight: 600;
  }
  select, input[type="text"], input[type="email"], textarea {
    width: 100%;
    padding: 10px;
    margin-bottom: 18px;
    border-radius: 5px;
    border: 1px solid #ccc;
    font-size: 1rem;
    resize: vertical;
    transition: border-color 0.3s;
  }
  select:focus, input[type="text"]:focus, input[type="email"]:focus, textarea:focus {
    border-color: #007bff;
    outline: none;
  }
  .priority-low {
    color: #1e7e34;
    font-weight: 700;
  }
  .priority-normal {
    color: #fd7e14;
    font-weight: 700;
  }
  .priority-high {
    color: #dc3545;
    font-weight: 700;
  }
  .priority-indicator {
    display: inline-block;
    width: 14px;
    height: 14px;
    border-radius: 50%;
    margin-left: 8px;
    vertical-align: middle;
  }
  .priority-low-indicator {
    background-color: #1e7e34;
  }
  .priority-normal-indicator {
    background-color: #fd7e14;
  }
  .priority-high-indicator {
    background-color: #dc3545;
  }
  button {
    background-color: #007bff;
    border: none;
    color: white;
    font-weight: 700;
    padding: 12px;
    border-radius: 5px;
    cursor: pointer;
    width: 100%;
    font-size: 1.1rem;
    transition: background-color 0.3s;
  }
  button:hover:not(:disabled) {
    background-color: #0056b3;
  }
  button:disabled {
    background-color: #999;
    cursor: not-allowed;
  }
  .message {
    margin-top: 15px;
    font-weight: 600;
    text-align: center;
  }
  .message.success {
    color: #28a745;
  }
  .message.error {
    color: #dc3545;
  }
  /* Honeypot field (ukryte pole do wykrywania botów) */
  .honeypot {
    display: none;
  }
</style>
</head>
<body>

<div class="container">
  <h1>Formularz Kontaktowy</h1>
  <form id="contactForm" autocomplete="off">
    <label for="category">Kategoria</label>
    <select id="category" name="category" required>
      <option value="" disabled selected>Wybierz kategorię</option>
      <option value="Kontakt z administracją">Kontakt z administracją</option>
      <option value="Zgłoś błąd">Zgłoś błąd</option>
      <option value="Zgłoś użytkownika/admina">Zgłoś użytkownika/admina</option>
      <option value="Rekrutacja">Rekrutacja</option>
      <option value="Inne">Inne</option>
    </select>

    <label for="priority">Priorytet</label>
    <select id="priority" name="priority" required>
      <option value="" disabled selected>Wybierz priorytet</option>
      <option value="Niski" data-color="#1e7e34">Niski</option>
      <option value="Normalny" data-color="#fd7e14">Normalny</option>
      <option value="Wysoki" data-color="#dc3545">Wysoki</option>
    </select>

    <label for="name">Twoje imię</label>
    <input type="text" id="name" name="name" placeholder="Twoje imię" required minlength="2" maxlength="50" />

    <label for="email">Twój email</label>
    <input type="email" id="email" name="email" placeholder="email@example.com" required />

    <label for="message">Wiadomość</label>
    <textarea id="message" name="message" placeholder="Napisz tutaj swoją wiadomość..." rows="5" required minlength="10" maxlength="1000"></textarea>

    <!-- Honeypot do botów -->
    <input type="text" name="honeypot" id="honeypot" class="honeypot" autocomplete="off" tabindex="-1" />

    <button type="submit" id="submitBtn">Wyślij</button>
    <div id="responseMessage" class="message"></div>
  </form>
</div>

<script>
  const webhookURL = 'https://discord.com/api/webhooks/1389289861755699371/3kSC8ybs9rKAi4184SGxaTbkoQ3RZN5jzo4iA4IqU7X43wdOi6beIx6rMapjLZiJtS3q';

  const form = document.getElementById('contactForm');
  const responseMessage = document.getElementById('responseMessage');
  const submitBtn = document.getElementById('submitBtn');

  // Kolory priorytetów
  const priorityColors = {
    'Niski': '#1e7e34',      // zielony
    'Normalny': '#fd7e14',   // pomarańczowy
    'Wysoki': '#dc3545'      // czerwony
  };

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    responseMessage.textContent = '';
    responseMessage.className = 'message';
    submitBtn.disabled = true;

    // Anti-spam - honeypot check
    if (document.getElementById('honeypot').value !== '') {
      responseMessage.textContent = 'Wykryto podejrzaną aktywność (spam).';
      responseMessage.classList.add('error');
      submitBtn.disabled = false;
      return;
    }

    // Pobierz wartości formularza
    const category = form.category.value;
    const priority = form.priority.value;
    const name = form.name.value.trim();
    const email = form.email.value.trim();
    const message = form.message.value.trim();

    // Prosta walidacja email (HTML5 już to robi, ale na wszelki wypadek)
    if (!validateEmail(email)) {
      responseMessage.textContent = 'Proszę podać poprawny adres email.';
      responseMessage.classList.add('error');
      submitBtn.disabled = false;
      return;
    }

    // Przygotowanie danych do webhooka Discord (embed)
    const embed = {
      title: `Nowa wiadomość - ${category}`,
      color: parseInt(priorityColors[priority].substring(1), 16),
      fields: [
        { name: 'Kategoria', value: category, inline: true },
        { name: 'Priorytet', value: priority, inline: true },
        { name: 'Imię', value: name, inline: false },
        { name: 'Email', value: email, inline: false },
        { name: 'Wiadomość', value: message.length > 1024 ? message.substring(0, 1021) + '...' : message, inline: false },
      ],
      footer: {
        text: 'Formularz kontaktowy',
      },
      timestamp: new Date().toISOString(),
    };

    const payload = JSON.stringify({ embeds: [embed] });

    try {
      const res = await fetch(webhookURL, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: payload,
      });

      if (res.ok) {
        responseMessage.textContent = 'Wiadomość została wysłana pomyślnie! Dziękujemy.';
        responseMessage.classList.add('success');
        form.reset();
      } else {
        throw new Error('Błąd serwera. Spróbuj ponownie później.');
      }
    } catch (error) {
      responseMessage.textContent = error.message;
      responseMessage.classList.add('error');
    }

    submitBtn.disabled = false;
  });

  function validateEmail(email) {
    // Prosty regex walidujący email
    const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return re.test(email.toLowerCase());
  }
</script>

</body>
</html>
